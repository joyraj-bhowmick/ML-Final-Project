# ML-Final-Project: What is the next best song?
Predict the next best song given an input song. Given an input song, our algorithm tries to predict the playlist so that another song from the same playlist can be played.

## gen_dataset.py
Code to generate training and testing features and labels as .npy files from given .tsv files of song features and metadata.

## main_densenet.py
Code containing the neural network model class definition, training and prediction. The model used is a dense neural network:
1) input layer: input=13, output=30
2) hidden layer: input=30, output=1
This final output is a regression value.

## loss_plot.py
Code to generate a plot of training loss over the epochs.

## prediction_accuracy
Code to calculate the model's prediction accuracy. This is based on the number of correctly predicted playlists given a song.

## datasets
Contains all training and testing datasets.

## log_files
Contains the logs of model training.

## model_files
Contains the generated pytorch model.

## utils
Contains helper functions.

## densenet_predictions.csv
Predictions generated by the model on testing data.

## unique_decs.npy
List of unique dance energy correlation (engineered feature). Used for calculating model accuracy.

# To run the program:
1) Generate training and testing dataset.

```python3 gen_dataset.py```

2) Train the model.

```python3 main_densenet.py --mode "train" --dataDir "datasets" --logDir "log_files" --modelSaveDir "model_files" --LR 0.001 --bs 50 --epochs 2000```

(Change model parameters LR, bs, and epochs as needed.)

3) Test the model.

```python3 main_densenet.py --mode "predict" --dataDir "datasets" --weights "model_files/densenet.pt" --predictionsFile "densenet_predictions.csv"```

4) Visualize training loss.

```python3 loss_plot.py```

5) Calculate model accuracy.

```python3 prediction_accuracy.py```
